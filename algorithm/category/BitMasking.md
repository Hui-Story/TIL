[TOC]

# 비트마스킹 (BitMasking) [Python]

> 컴퓨터의 최소 연산 단위는 **bit** 이며, 이는 이진수를 나타내기 위한 0과 1로만 이루어져 있다.
> 이러한 **bit** 를 활용하여 정수의 이진수 표현을 자료구조로 쓰는 기법

- 비트 연산은 삽입, 삭제, 조회가 빠르다.
- 코드가 비교적 간결해진다.
- 정수 표현으로 DP 문제를 해결할 수 있다.

**[기존의 방문 체크]**

```python
visited = [False] * 10
```

**[비트마스킹 활용]**

```python
visited = 0b0000000000
```

- 비트마스크는 하위 주소(오른쪽)부터 인덱스를 세면 된다.

  - 4번째 도시를 방문한 경우

    ```python
    visited = 0b0000001000
    ```

<br>

## 비트 연산의 종류

### 1. AND 연산 (&)

- 같은 자리에 대응하는 숫자가 모두 1이면 1 반환

  ```python
  bin(0b1010011010 & 0b1101101100)  # 0b1000001000
  ```

### 2. OR 연산 (|)

- 같은 자리에 대응하는 숫자에서 1이 한 개라도 있으면 1 반환

  ```python
  bin(0b1010011010 | 0b1101101100)  # 0b1111111110
  ```

### 3. XOR 연산 (^)

- 같은 자리에 대응하는 숫자가 서로 다르면 1 반환

  ```python
  bin(0b1010011010 ^ 0b1101101100)  # 0b111110110
  ```

### 4. NOT 연산 (~)

- 비트값이 1이면 0으로, 0이면 1로 바꿈

  ```python
  bin(~0b01100100)  # -0b1100101
  ```

### 5. 왼쪽, 오른쪽 Shift (<<, >>)

- **왼쪽 Shift (<<)** : 왼쪽으로 비트를 옮김 (A * 2^B 의 의미)

  ```python
  bin(0b00001010 << 2)  # 0b101000
  ```

- **오른쪽 Shift (>>)** : 오른쪽으로 비트를 옮김 (A / 2^B 의 의미)

  ```python
  bin(0b00001010 >> 2)  # 0b10
  ```

<br>

## 비트 연산 활용

### 1. 원소 추가

- n 번째의 원소를 1로 바꿈

  ```python
  n = 3
  bin(0b0010 | (1 << n))  # 0b1010
  ```

### 2. 원소 삭제

- n 번째의 원소를 0으로 바꿈

  ```python
  n = 3
  bin(0b1010 & ~(1 << n))  # 0b10
  ```

### 3. 원소 조회

- 리턴값이 0인 경우 n 번째에 원소가 없음

  ```python
  n = 3
  bin(0b1010 & (1 << n))  # 0b1000
  ```

### 4. 원소 역전 (토글)

- n 번째의 원소를 역전시켜 flag 처럼 사용할 수 있음

  ```python
  n = 3
  bin(0b1010 ^ (1 << n))  # 0b10
  ```

### 5. 원소 비우기 및 채우기

- 원소를 모두 0으로 비우기

  ```python
  bin(0)  # 0b0
  ```

- n 자리의 원소를 모두 1 로 채우기

  ```python
  bin((1 << 6) - 1)  # 0b111111
  ```

<br>

## 비트 마스크와 집합

> 집합 자체의 연산도 비트 마스킹을 통해 구현할 수 있다.

### 1. 집합끼리의 연산

```python
A = 0b11110001
B = 0b11011000

# 합집합
bin(A | B)  # 0b11111001
# 교집합
bin(A & B)  # 0b11010000
# 차집합 (A - B)
bin(A & ~B)  # 0b100001
# A와 B 중 하나에만 포함된 원소들의 집합
bin(A ^ B)  # 0b101001
```

### 2. 집합의 크기

- 비트에서 1인 비트의 수 (**재귀 함수**로 구현)

  ```python
  def bitCount(x):
      if x == 0: return 0
      return x % 2 + bitCount(x // 2)
  ```

  > `x % 2` 는 마지막 비트, `x // 2` 는 마지막 비트의 삭제를 의미

<br>

## [참고자료]

- [[Python] 비트마스크(Bit Mask)](https://studyandwrite.tistory.com/325)
- [[Python] 비트 마스킹 정리](https://velog.io/@1998yuki0331/Python-%EB%B9%84%ED%8A%B8-%EB%A7%88%EC%8A%A4%ED%82%B9-%EC%A0%95%EB%A6%AC)